# Tolstoy Semantic Search

Веб-приложение для семантического поиска по произведениям Л.Н. Толстого.

## Описание

Приложение использует векторные представления текстов для поиска произведений и отрывков по смыслу, а не по ключевым словам. Система находит семантически близкие тексты к заданному запросу.

## Функциональность

- **Семантический поиск по отрывкам**: Поиск наиболее релевантных отрывков из произведений Толстого
- **Поиск по произведениям**: Поиск целых произведений, соответствующих запросу
- **Визуализация**: Графическое представление семантического пространства произведений
- **История поиска**: Сохранение истории запросов пользователя
- **Статистика**: Информация о корпусе текстов

## Технологии

- **Backend**: Flask (Python)
- **Модель эмбеддингов**: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
- **Векторный поиск**: cosine similarity
- **Визуализация**: Plotly
- **Фронтенд**: HTML, CSS, JavaScript

## Структура проекта

```
tolstoy_search/
├── app.py                 # Основное Flask-приложение
├── search_engine.py       # Поисковый движок
├── requirements.txt       # Зависимости Python
├── static/
│   └── style.css         # Стили CSS
├── templates/            # HTML шаблоны
│   ├── base.html         # Базовый шаблон
│   ├── index.html        # Главная страница
│   ├── search.html       # Страница результатов
│   ├── history.html      # История поиска
│   ├── stats.html        # Статистика
│   ├── visualization.html # Визуализация
│   └── work.html         # Страница произведения
└── data/                 # Данные (эмбеддинги, метаданные)
```

## Установка и запуск локально

1. Клонировать репозиторий:
   ```bash
   git clone <repository-url>
   cd tolstoy_search
   ```

2. Установить зависимости:
   ```bash
   pip install -r requirements.txt
   ```

3. Запустить приложение:
   ```bash
   python app.py
   ```

4. Открыть в браузере: `http://localhost:5000`

## Деплой на Render.com (бесплатный хостинг)

Приложение готово к деплою на Render.com. Для развертывания:

1. **Создайте аккаунт на [Render.com](https://render.com)** (можно войти через GitHub)

2. **Создайте новый Web Service:**
   - Нажмите "New +" → "Web Service"
   - Подключите ваш GitHub репозиторий
   - Выберите репозиторий `tolstoy-semantic-search`

3. **Настройки деплоя:**
   - **Name:** `tolstoy-search` (или любое другое)
   - **Environment:** `Python 3`
   - **Region:** `Frankfurt` (или ближайший к вам)
   - **Branch:** `main`
   - **Build Command:** `pip install -r requirements.txt`
   - **Start Command:** `gunicorn app:app`

4. **Дополнительные настройки (опционально):**
   - **Plan:** `Free` (бесплатный тариф)
   - **Auto-Deploy:** `Yes` (автоматический деплой при пуше в main)
   - **Environment Variables:**
     - `PYTHON_VERSION`: `3.11.0`
     - `FLASK_DEBUG`: `False`

5. **Нажмите "Create Web Service"** и дождитесь деплоя (5-10 минут)

6. **После успешного деплоя** приложение будет доступно по URL вида: `https://tolstoy-search.onrender.com`

**Важно:** На бесплатном тарифе Render приложение останавливается после 15 минут бездействия. Первый запрос после простоя может занять 30-60 секунд для "пробуждения" сервиса.

## Альтернативный хостинг

Приложение также можно развернуть на других платформах:

### Railway.app
- Используйте `Procfile` и `requirements.txt`
- Бесплатный кредит $5 в месяц

### PythonAnywhere
- Загрузите файлы через интерфейс
- Настройте WSGI конфигурацию для Flask

### Heroku
- Требуется привязанная карта (платный тариф)

## Данные

Проект использует предварительно обработанные данные:
- Векторные представления произведений
- Метаданные произведений
- Тексты произведений с пунктуацией

## Оптимизация

Код проекта был оптимизирован:
- Удалены неиспользуемые файлы и код
- Упрощена логика обработки текстов
- Убраны избыточные отладочные сообщения
- Сохранена вся основная функциональность

## Автор

Мария Дижевская

## Лицензия

Дипломный проект, 2026
